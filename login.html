<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录 / 注册 </title>
    <style>
        /* === 基础样式 === */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f5f6;
            color: #333;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* 卡片容器 */
        .login-card {
            background: #fff;
            width: 420px;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            text-align: center;
            position: relative;
        }

        /* Logo */
        .logo {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 30px;
            display: inline-block;
            text-decoration: none;
            color: #000;
            letter-spacing: -1px;
        }
        .logo span { color: #FFCC32; }

        /* 标题 */
        .card-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 25px;
            color: #222;
        }

        /* 表单区域 */
        .form-group {
            margin-bottom: 20px;
            text-align: left;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #666;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #eee;
            background-color: #f9f9f9;
            border-radius: 8px;
            font-size: 15px;
            outline: none;
            transition: all 0.3s;
        }

        .form-input:focus {
            background-color: #fff;
            border-color: #FFCC32;
        }

        /* 错误状态样式 */
        .form-input.error {
            border-color: #ff4d4f;
            background-color: #fff1f0;
            color: #ff4d4f;
        }

        /* 错误提示文字 */
        .error-msg {
            color: #ff4d4f;
            font-size: 12px;
            margin-top: 5px;
            display: none; /* 默认隐藏 */
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 按钮 */
        .submit-btn {
            width: 100%;
            padding: 14px;
            background-color: #FFCC32;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.2s;
        }

        .submit-btn:hover { background-color: #f0be20; }
        
        /* 底部切换链接 */
        .toggle-box {
            margin-top: 25px;
            font-size: 14px;
            color: #666;
        }

        .toggle-link {
            color: #FFCC32;
            font-weight: bold;
            cursor: pointer;
            text-decoration: underline;
            margin-left: 5px;
        }

        .back-home {
            position: absolute; top: 20px; left: 20px;
            font-size: 14px; color: #bbb; text-decoration: none;
        }
        .back-home:hover { color: #333; }
        
        #confirm-password-group { display: none; }
    </style>
</head>
<body>
    <div class="login-card">
        <a href="index.html" class="back-home">← 返回首页</a>

        <a href="index.html" class="logo"><span>HHH</span>performance</a>
        
        <div class="card-title" id="pageTitle">账号登录</div>
        
        <!-- 表单提交时触发 handleSubmit -->
        <form id="authForm" onsubmit="return handleSubmit(event)">
            
            <!-- 手机号: 限制11位，实时只能输数字 -->
            <div class="form-group">
                <label class="form-label">手机号码</label>
                <input type="text" id="phone" class="form-input" 
                       placeholder="请输入11位手机号" 
                       maxlength="11" 
                       oninput="handlePhoneInput(this)" 
                       onblur="validatePhone()">
                <!-- 错误提示容器 -->
                <div class="error-msg" id="phone-error">请输入正确的11位手机号</div>
            </div>
            
            <!-- 密码: 长度校验 -->
            <div class="form-group">
                <label class="form-label">密码</label>
                <input type="password" id="password" class="form-input" 
                       placeholder="请输入密码 (6位及以上)"
                       onblur="validatePassword()">
                <div class="error-msg" id="password-error">密码长度至少需6位</div>
            </div>

            <!-- 确认密码 (仅注册模式显示) -->
            <div class="form-group" id="confirm-password-group">
                <label class="form-label">确认密码</label>
                <input type="password" id="confirm-password" class="form-input" placeholder="请再次输入密码">
                <div class="error-msg" id="confirm-password-error">两次输入的密码不一致</div>
            </div>

            <button type="submit" class="submit-btn" id="submitBtn">立即登录</button>
        </form>

        <div class="toggle-box">
            <span id="toggleText">还没有账号？</span>
            <span class="toggle-link" onclick="toggleMode()" id="toggleLink">去注册</span>
        </div>
    </div>

    <script>
        // 当前模式：false=登录，true=注册
        let isRegisterMode = false;

        // 切换 登录/注册 模式
        function toggleMode() {
            isRegisterMode = !isRegisterMode;
            const pageTitle = document.getElementById('pageTitle');
            const submitBtn = document.getElementById('submitBtn');
            const toggleText = document.getElementById('toggleText');
            const toggleLink = document.getElementById('toggleLink');
            const confirmGroup = document.getElementById('confirm-password-group');
            
            clearErrors(); // 切换时清除之前的错误提示

            if (isRegisterMode) {
                pageTitle.textContent = "注册新账号";
                submitBtn.textContent = "立即注册";
                toggleText.textContent = "已有账号？";
                toggleLink.textContent = "去登录";
                confirmGroup.style.display = "block";
            } else {
                pageTitle.textContent = "账号登录";
                submitBtn.textContent = "立即登录";
                toggleText.textContent = "还没有账号？";
                toggleLink.textContent = "去注册";
                confirmGroup.style.display = "none";
            }
        }

        // 清除所有错误状态
        function clearErrors() {
            const inputs = document.querySelectorAll('.form-input');
            const msgs = document.querySelectorAll('.error-msg');
            inputs.forEach(input => input.classList.remove('error'));
            msgs.forEach(msg => msg.style.display = 'none');
        }

        // 显示错误函数
        function showError(inputId, msgId, message) {
            const input = document.getElementById(inputId);
            const msg = document.getElementById(msgId);
            input.classList.add('error');
            msg.innerText = message;
            msg.style.display = 'block';
        }

        // === 1. 手机号输入处理 (实时) ===
        function handlePhoneInput(input) {
            // 强制替换非数字字符
            input.value = input.value.replace(/\D/g, '');
            
            // 如果用户正在修改且之前有错误，尝试隐藏错误
            if (input.classList.contains('error')) {
                input.classList.remove('error');
                document.getElementById('phone-error').style.display = 'none';
            }
        }

        // === 2. 手机号校验逻辑 ===
        function validatePhone() {
            const phoneInput = document.getElementById('phone');
            const phone = phoneInput.value.trim();
            // 校验规则：11位数字，且以1开头
            const phoneRegex = /^1\d{10}$/;

            if (!phone) {
                showError('phone', 'phone-error', '手机号不能为空');
                return false;
            } else if (phone.length !== 11) {
                showError('phone', 'phone-error', '手机号必须是11位数字');
                return false;
            } else if (!phoneRegex.test(phone)) {
                showError('phone', 'phone-error', '请输入有效的手机号格式');
                return false;
            }
            return true;
        }

        // === 3. 密码校验逻辑 ===
        function validatePassword() {
            const password = document.getElementById('password').value.trim();
            if (!password) {
                // 如果为空，暂不报错，提交时再报
                return false; 
            } else if (password.length < 6) {
                showError('password', 'password-error', '密码长度至少需6位');
                return false;
            } else {
                // 清除错误
                const input = document.getElementById('password');
                const msg = document.getElementById('password-error');
                input.classList.remove('error');
                msg.style.display = 'none';
                return true;
            }
        }

        // === 4. 提交拦截逻辑 ===
        function handleSubmit(e) {
            e.preventDefault(); // 核心：阻止表单默认提交跳转
            
            // 重新执行校验
            const isPhoneValid = validatePhone();
            const password = document.getElementById('password').value.trim();
            let isPassValid = true;

            // 密码校验
            if (!password) {
                showError('password', 'password-error', '密码不能为空');
                isPassValid = false;
            } else if (password.length < 6) {
                showError('password', 'password-error', '密码长度至少需6位');
                isPassValid = false;
            }

            // 注册模式下的确认密码校验
            let isConfirmValid = true;
            if (isRegisterMode) {
                const confirmPassword = document.getElementById('confirm-password').value.trim();
                if (!confirmPassword) {
                    showError('confirm-password', 'confirm-password-error', '请确认密码');
                    isConfirmValid = false;
                } else if (password !== confirmPassword) {
                    showError('confirm-password', 'confirm-password-error', '两次输入的密码不一致');
                    isConfirmValid = false;
                }
            }

            // 综合判断：只要有一项不通过，就拦截
            if (!isPhoneValid || !isPassValid || !isConfirmValid) {
                console.log("校验失败，禁止登录");
                return false;
            }

            // 校验通过，执行后续逻辑
            if (isRegisterMode) {
                alert("注册成功！账号：" + document.getElementById('phone').value);
                // 模拟自动登录
                setTimeout(() => { window.location.href = "index.html"; }, 1000);
            } else {
                alert("登录成功！即将跳转...");
                setTimeout(() => { window.location.href = "index.html"; }, 500);
            }
            
            return false;
        }
    </script>
</body>
</html>